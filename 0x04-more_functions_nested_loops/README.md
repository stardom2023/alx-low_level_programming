more function, more nested loop
